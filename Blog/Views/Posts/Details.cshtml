@model Blog.Models.Post

@{
    ViewBag.Title = "Details";
    bool isAdmin = ViewBag.IsAdmin ?? false;
}
<script src="~/Scripts/jquery-1.8.2.min.js"></script>
<script src="~/Scripts/jquery.unobtrusive-ajax.js"></script>

<div id="postDetails">
    @PostHelper.Render(Model, Html, isAdmin, true)
</div>

<script>
    $('#commentSubmitBtn').click(function () {
        var linkUrl = $(this).attr("data-href");
        var linkTarget = $(this).attr("target-href");
        $.ajax({
            url: linkUrl,
            type: 'Post',
            data: $('#commentForm').serialize()
        })
        .done(function (result) {
            if (result.success) {
                $.ajax({
                    url: linkTarget,
                    type: 'Get',
                    contentType: 'application/json; charset=utf-8',
                })
                .done(function (response) {
                    var comments = response.comments

                    var date = new Date();
                    var currentDay = (date.getDate() < 10 ? '0' : '') + date.getDate();
                    var currentMonth = ((date.getMonth() + 1) < 10 ? '0' : '') + (date.getMonth() + 1);
                    var strDate = "at " + date.getHours() + ":" + date.getMinutes() + " on " + currentDay + "-" + currentMonth + "-" + date.getFullYear();

                    $.each(comments, function (index, comment) {
                        var value = comment[comment.length - 1];

                        var commenthtml = "<div class='comment'> <div class='commentName'>" + value.Name + "  said : </div> <div class='commentBody'>"
                            + value.Body + "</div> <div class='commentTime'>" + strDate + "</div> </div> </br>";

                        $(".comments").prepend(commenthtml);

                        debugger;
                    })
                    debugger;
                });
                debugger;
            }
            debugger;
        });
        debugger;
    });
</script>